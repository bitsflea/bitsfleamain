export BOS_API_URL="https://api-bostest.blockzone.net"
export SYMBOL="BOS"
export USE_OLD_RPC="--use-old-rpc"
export CONTRACT_ACCOUNT="bitsfleatest"
export CONTRACT_ACTIVE_KEY="EOS6RqCkXZMkevBrbApMJLqyZntPErav8PQvP1NeNTJawHkTC4bzd"
# buy resources
cleos -u $BOS_API_URL get currency balance eosio.token $CONTRACT_ACCOUNT BOS
cleos -u $BOS_API_URL system buyram $CONTRACT_ACCOUNT $CONTRACT_ACCOUNT "8400 ${SYMBOL}" $USE_OLD_RPC
cleos -u $BOS_API_URL system delegatebw $CONTRACT_ACCOUNT $CONTRACT_ACCOUNT "10 ${SYMBOL}" "400 ${SYMBOL}" $USE_OLD_RPC
# deploy
cleos wallet unlock -n bostest  --password PW5KajM5kmn6YSckdg3hWregB1bGQ3VMKeUpSyHDMXuukZZnTiyFj
cleos -u $BOS_API_URL set contract $CONTRACT_ACCOUNT ./build/bitsfleamain -p $CONTRACT_ACCOUNT $USE_OLD_RPC &&
CONTRACT_DATA='{"threshold": 1,"keys": [{"key": "'${CONTRACT_ACTIVE_KEY}'","weight": 1}],"accounts": [{"permission":{"actor":"'${CONTRACT_ACCOUNT}'","permission":"eosio.code"},"weight":1}]}'
cleos -u $BOS_API_URL set account permission -p $CONTRACT_ACCOUNT $USE_OLD_RPC $CONTRACT_ACCOUNT active "$CONTRACT_DATA" owner &&
cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT init '[]' -p $CONTRACT_ACCOUNT $USE_OLD_RPC &&
# reg user
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT reguser '[reviewer1111,"reviewer1111","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B492","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B492",0,"EOS5BiYrPwXwFmrjLQ3ZUa3BX9crdomJNfYdu6uC863XAXrHNyWbo"]' -p $CONTRACT_ACCOUNT $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT reguser '[reviewer1112,"reviewer1112","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B493","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B493",0,"EOS5BiYrPwXwFmrjLQ3ZUa3BX9crdomJNfYdu6uC863XAXrHNyWbo"]' -p $CONTRACT_ACCOUNT $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT reguser '[reviewer1113,"reviewer1113","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B494","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B494",0,"EOS5BiYrPwXwFmrjLQ3ZUa3BX9crdomJNfYdu6uC863XAXrHNyWbo"]' -p $CONTRACT_ACCOUNT $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT reguser '[bitsflea1111,"bitsflea1111","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B495","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B495",0,"EOS5BiYrPwXwFmrjLQ3ZUa3BX9crdomJNfYdu6uC863XAXrHNyWbo"]' -p $CONTRACT_ACCOUNT $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT reguser '[bitsflea1112,"bitsflea1112","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B496","05FBED483A974456708EF12FCF3D278276E982234D775ECEE0DFA5CB49B8B496",0,"EOS5BiYrPwXwFmrjLQ3ZUa3BX9crdomJNfYdu6uC863XAXrHNyWbo"]' -p $CONTRACT_ACCOUNT $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT appreviewer '[0,"reviewer1111"]' -p reviewer1111 $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT appreviewer '[1,"reviewer1112"]' -p reviewer1112 $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT appreviewer '[2,"reviewer1113"]' -p reviewer1113 $USE_OLD_RPC &&
# # vote reviewer
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT votereviewer '[2,"reviewer1111",0,true]' -p reviewer1111 $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT votereviewer '[3,"bitsflea1111",1,true]' -p bitsflea1111 $USE_OLD_RPC &&
# cleos -u $BOS_API_URL push action $CONTRACT_ACCOUNT votereviewer '[3,"bitsflea1111",2,true]' -p bitsflea1111 $USE_OLD_RPC &&
cleos -u $BOS_API_URL get table $CONTRACT_ACCOUNT $CONTRACT_ACCOUNT global